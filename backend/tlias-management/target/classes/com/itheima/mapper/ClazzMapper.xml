<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itheima.mapper.ClazzMapper">

    <!--添加班级-->
    <insert id="insert" >
        insert into clazz(name, room, begin_date, end_date, master_id, subject, create_time, update_time)
        values (#{name}, #{room}, #{beginDate}, #{endDate}, #{masterId}, #{subject}, #{createTime}, #{updateTime} )
    </insert>

    <!--分页查询/条件查询-->
    <select id="getClazzs" resultType="com.itheima.pojo.Clazz">
        select c.*, e.name master_name from clazz c left join emp e on c.master_id = e.id
            <where>
                <if test="name != null and name != '' ">
                    c.name like concat('%', #{name}, '%')
                </if>
                <if test="begin != null">
                    and c.begin_date &gt;= #{begin}
                </if>
                <if test="end != null">
                    and c.end_date &lt;= #{end}
                </if>
            </where>

    </select>

    <!--查询每个班级人数-->
    <select id="countClazzNameData" resultType="java.util.Map">
        select name clazzName, count(*) total
            from clazz group by clazzName
        order by total
    </select>

    <!--统计学员的学历信息-->
    <select id="countStudentDegreeData" resultType="map">
        select
            case degree
                WHEN 1 THEN '初中'
                WHEN 2 THEN '高中'
                WHEN 3 THEN '大专'
                WHEN 4 THEN '本科'
                WHEN 5 THEN '硕士'
                WHEN 6 THEN '博士'
                ELSE '未知'  -- 可选：处理异常值（如 degree 超出 1-6 的情况）
                END AS name,  -- 给转换后的字段起别名
            COUNT(*) AS value  -- 统计数量
        from student group by degree
    </select>

</mapper>


